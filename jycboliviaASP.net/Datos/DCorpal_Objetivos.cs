using jycboliviaASP.net.Negocio;
using jycboliviaASP.net.Presentacion;
using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Web;
using static jycboliviaASP.net.Negocio.NA_APIcompras;

namespace jycboliviaASP.net.Datos
{
    public class DCorpal_Objetivos
    {
        private conexionMySql conexion = new conexionMySql();
   
        public  DCorpal_Objetivos() { }

        internal DataSet get_ListaObjetivoProduccionyVentasAnual(int gestion)
        {
            string consulta = "SELECT "+
                             " SUM(CASE WHEN op.`mes` = 1 THEN op.`cantidadprod` ELSE 0 END) as 'Enero-Objetivo', "+
                             " IFNULL(enero.OrdenProduccion, 0) as 'Enero-OrdenProd', "+
                             " IFNULL(Enerosolic.cantidad, 0) as 'Enero-SoliProd', "+  
                             " SUM(CASE WHEN op.`mes` = 2 THEN op.`cantidadprod` ELSE 0 END) as 'Febrero-Objetivo', "+
                             " IFNULL(febrero.OrdenProduccion, 0) as 'Febrero-OrdenProd', "+
                             " IFNULL(Febrerosolic.cantidad, 0) as 'Febrero-SoliProd', "+
                             " SUM(CASE WHEN op.`mes` = 3 THEN op.`cantidadprod` ELSE 0 END) as 'Marzo-Objetivo', "+
                             " IFNULL(marzo.OrdenProduccion, 0) as 'Marzo-OrdenProd', "+
                             " IFNULL(Marzosolic.cantidad, 0) as 'Marzo-SoliProd', "+
                             " SUM(CASE WHEN op.`mes` = 4 THEN op.`cantidadprod` ELSE 0 END) as 'Abril-Objetivo', "+
                             " IFNULL(abril.OrdenProduccion, 0) as 'Abril-OrdenProd', "+
                             " IFNULL(Abrilsolic.cantidad, 0) as 'Abril-SoliProd', "+ 
                             " SUM(CASE WHEN op.`mes` = 5 THEN op.`cantidadprod` ELSE 0 END) as 'Mayo-Objetivo', "+
                             " IFNULL(mayo.OrdenProduccion, 0) as 'Mayo-OrdenProd', "+
                             " IFNULL(Mayosolic.cantidad, 0) as 'Mayo-SoliProd', "+ 
                             " SUM(CASE WHEN op.`mes` = 6 THEN op.`cantidadprod` ELSE 0 END) as 'Junio-Objetivo', "+
                             " IFNULL(junio.OrdenProduccion, 0) as 'Junio-OrdenProd', "+
                             " IFNULL(Juniosolic.cantidad, 0) as 'Junio-SoliProd', "+ 
                             " SUM(CASE WHEN op.`mes` = 7 THEN op.`cantidadprod` ELSE 0 END) as 'Julio-Objetivo', "+
                             " IFNULL(julio.OrdenProduccion, 0) as 'Julio-OrdenProd', "+
                             " IFNULL(Juliosolic.cantidad, 0) as 'Julio-SoliProd', "+ 
                             " SUM(CASE WHEN op.`mes` = 8 THEN op.`cantidadprod` ELSE 0 END) as 'Agosto-Objetivo', "+
                             " IFNULL(agosto.OrdenProduccion, 0) as 'Agosto-OrdenProd', "+
                             " IFNULL(Agostosolic.cantidad, 0) as 'Agosto-SoliProd', "+ 
                             " SUM(CASE WHEN op.`mes` = 9 THEN op.`cantidadprod` ELSE 0 END) as 'Septiembre-Objetivo', "+
                             " IFNULL(septiembre.OrdenProduccion, 0) as 'Septiembre-OrdenProd', "+
                             " IFNULL(Septiembresolic.cantidad, 0) as 'Septiembre-SoliProd', "+ 
                             " SUM(CASE WHEN op.`mes` = 10 THEN op.`cantidadprod` ELSE 0 END) as 'Octubre-Objetivo', "+
                             " IFNULL(octubre.OrdenProduccion, 0) as 'Octubre-OrdenProd', "+
                             " IFNULL(Octubresolic.cantidad, 0) as 'Octubre-SoliProd', "+ 
                             " SUM(CASE WHEN op.`mes` = 11 THEN op.`cantidadprod` ELSE 0 END) as 'Noviembre-Objetivo', "+
                             " IFNULL(noviembre.OrdenProduccion, 0) as 'Noviembre-OrdenProd', "+
                             " IFNULL(Noviembresolic.cantidad, 0) as 'Noviembre-SoliProd', "+ 
                             " SUM(CASE WHEN op.`mes` = 12 THEN op.`cantidadprod` ELSE 0 END) as 'Diciembre-Objetivo', "+
                             " IFNULL(diciembre.OrdenProduccion, 0) as 'Diciembre-OrdenProd', "+
                             " IFNULL(Diciembresolic.cantidad, 0) as 'Diciembre-SoliProd' "+
                             " FROM    tbcorpal_producto p LEFT JOIN tbcorpal_objetivosproduccionmensual op ON p.`codigo` = op.`codprod` AND op.anio =  " + gestion+"   LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 1    GROUP BY     dsp.`codproducto` ) as Enerosolic ON p.`codigo` = Enerosolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 2    GROUP BY     dsp.`codproducto` ) as Febrerosolic  ON p.`codigo` = Febrerosolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 3    GROUP BY     dsp.`codproducto` ) as Marzosolic  ON p.`codigo` = Marzosolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 4    GROUP BY     dsp.`codproducto` ) as Abrilsolic  ON p.`codigo` = Abrilsolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 5    GROUP BY     dsp.`codproducto` ) as Mayosolic  ON p.`codigo` = Mayosolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 6    GROUP BY     dsp.`codproducto` ) as Juniosolic  ON p.`codigo` = Juniosolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 7    GROUP BY     dsp.`codproducto` ) as Juliosolic  ON p.`codigo` = Juliosolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 8    GROUP BY     dsp.`codproducto` ) as Agostosolic ON p.`codigo` = Agostosolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 9   GROUP BY     dsp.`codproducto` ) as Septiembresolic  ON p.`codigo` = Septiembresolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 10   GROUP BY     dsp.`codproducto` ) as Octubresolic  ON p.`codigo` = Octubresolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 11   GROUP BY     dsp.`codproducto` ) as Noviembresolic  ON p.`codigo` = Noviembresolic.codigo LEFT JOIN  (   SELECT    dsp.`codproducto` AS 'codigo',   sp.`fechaentrega` AS 'fecha',   SUM(dsp.`cantentregada`) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.`codigo` = dsp.`codsolicitud`   WHERE    YEAR(sp.`fechaentrega`) =  "+gestion+" AND     MONTH(sp.`fechaentrega`) = 12   GROUP BY     dsp.`codproducto` ) as diciembresolic ON p.`codigo` = diciembresolic.codigo  ## ENERO LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-01-01')      AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-02-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-01-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-01-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-02-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-02-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS enero    ON p.codigo = enero.codProducto  ## FEBRERO LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-02-01')      AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-03-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-02-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-02-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-03-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-03-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS febrero    ON p.codigo = febrero.codProducto  ## MARZO LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-03-01')     AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-04-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-03-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-03-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-04-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-04-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS marzo    ON p.codigo = marzo.codProducto    ## ABRIL LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-04-01')      AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-05-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-04-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-04-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-05-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-05-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS abril    ON p.codigo = abril.codProducto      ## MAYO LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-05-01')      AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-06-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-05-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-05-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-06-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-06-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS mayo    ON p.codigo = mayo.codProducto    ## JUNIO LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-06-01')      AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-07-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-06-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-06-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-07-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-07-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS junio    ON p.codigo = junio.codProducto    ## JULIO LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-07-01')      AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-08-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-07-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-07-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-08-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-08-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS julio    ON p.codigo = julio.codProducto    ## AGOSTO LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-08-01')      AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-09-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-08-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-08-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-09-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-09-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS agosto    ON p.codigo = agosto.codProducto      ## SEPTIEMBRE LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-09-01')     AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-10-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-09-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-09-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-10-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-10-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS septiembre    ON p.codigo = septiembre.codProducto    ## OCTUBRE LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-10-01')     AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-11-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-10-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-10-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-11-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-11-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS octubre    ON p.codigo = octubre.codProducto    ## NOVIEMBRE LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-11-01')     AND op.`fechaproduccion` <= CONCAT( "+gestion+",'-12-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-11-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-11-01') AND op.`fechaproduccion` < CONCAT( "+gestion+",'-12-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+",'-12-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS noviembre   ON p.codigo = noviembre.codProducto    ## DICIEMBRE LEFT JOIN   (   SELECT     op.`codProductonax` AS 'codProducto',     op.`productoNax`,     SUM(op.`cantcajasproduccion`)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.`fechaproduccion` >= CONCAT( "+gestion+",'-12-01')      AND op.`fechaproduccion` <= CONCAT( "+gestion+"+1,'-01-01')     AND (         (op.`fechaproduccion` = CONCAT( "+gestion+",'-12-01') AND op.`horaproduccion` >= '07:00:00')         OR         (op.`fechaproduccion` > CONCAT( "+gestion+",'-12-01') AND op.`fechaproduccion` < CONCAT( "+gestion+"+1,'-01-01'))         OR         (op.`fechaproduccion` = CONCAT( "+gestion+"+1,'-01-01') AND op.`horaproduccion` < '07:00:00')     )   GROUP BY       op.`codProductonax`   ORDER BY     op.`fechaproduccion`, op.`horaproduccion`   ) AS diciembre    ON p.codigo = diciembre.codProducto; ";
            DataSet dato = conexion.consultaMySql(consulta);
            return dato;
        }

        internal DataSet montototalAnualObjetivosVentasProgramado()
        {
            string consulta = "SELECT   SUM(CASE WHEN op.mes = 1 THEN op.cantidadprod ELSE 0 END) as 'Enero-Objetivo',   SUM(IFNULL(enero.OrdenProduccion,0)) as 'Enero-OrdenProd',   SUM(IFNULL(Enerosolic.cantidad,0)) as 'Enero-SoliProd',      SUM(CASE WHEN op.mes = 2 THEN op.cantidadprod ELSE 0 END) as 'Febrero-Objetivo',   SUM(IFNULL(febrero.OrdenProduccion,0)) as 'Febrero-OrdenProd',   SUM(IFNULL(Febrerosolic.cantidad,0)) as 'Febrero-SoliProd',    SUM(CASE WHEN op.mes = 3 THEN op.cantidadprod ELSE 0 END) as 'Marzo-Objetivo',   SUM(IFNULL(marzo.OrdenProduccion,0)) as 'Marzo-OrdenProd',   SUM(IFNULL(Marzosolic.cantidad,0)) as 'Marzo-SoliProd',    SUM(CASE WHEN op.mes = 4 THEN op.cantidadprod ELSE 0 END) as 'Abril-Objetivo',   SUM(IFNULL(abril.OrdenProduccion,0)) as 'Abril-OrdenProd',   SUM(IFNULL(Abrilsolic.cantidad,0)) as 'Abril-SoliProd',      SUM(CASE WHEN op.mes = 5 THEN op.cantidadprod ELSE 0 END) as 'Mayo-Objetivo',   SUM(IFNULL(mayo.OrdenProduccion,0)) as 'Mayo-OrdenProd',   SUM(IFNULL(Mayosolic.cantidad,0)) as 'Mayo-SoliProd',      SUM(CASE WHEN op.mes = 6 THEN op.cantidadprod ELSE 0 END) as 'Junio-Objetivo',   SUM(IFNULL(junio.OrdenProduccion,0)) as 'Junio-OrdenProd',   SUM(IFNULL(Juniosolic.cantidad,0)) as 'Junio-SoliProd',      SUM(CASE WHEN op.mes = 7 THEN op.cantidadprod ELSE 0 END) as 'Julio-Objetivo',   SUM(IFNULL(julio.OrdenProduccion,0)) as 'Julio-OrdenProd',   SUM(IFNULL(Juliosolic.cantidad,0)) as 'Julio-SoliProd',      SUM(CASE WHEN op.mes = 8 THEN op.cantidadprod ELSE 0 END) as 'Agosto-Objetivo',   SUM(IFNULL(agosto.OrdenProduccion,0)) as 'Agosto-OrdenProd',   SUM(IFNULL(Agostosolic.cantidad,0)) as 'Agosto-SoliProd',      SUM(CASE WHEN op.mes = 9 THEN op.cantidadprod ELSE 0 END) as 'Septiembre-Objetivo',   SUM(IFNULL(septiembre.OrdenProduccion,0)) as 'Septiembre-OrdenProd',   SUM(IFNULL(Septiembresolic.cantidad,0)) as 'Septiembre-SoliProd',      SUM(CASE WHEN op.mes = 10 THEN op.cantidadprod ELSE 0 END) as 'Octubre-Objetivo',   SUM(IFNULL(octubre.OrdenProduccion,0)) as 'Octubre-OrdenProd',   SUM(IFNULL(Octubresolic.cantidad,0)) as 'Octubre-SoliProd',      SUM(CASE WHEN op.mes = 11 THEN op.cantidadprod ELSE 0 END) as 'Noviembre-Objetivo',   SUM(IFNULL(noviembre.OrdenProduccion,0)) as 'Noviembre-OrdenProd',   SUM(IFNULL(Noviembresolic.cantidad,0)) as 'Noviembre-SoliProd',      SUM(CASE WHEN op.mes = 12 THEN op.cantidadprod ELSE 0 END) as 'Diciembre-Objetivo',   SUM(IFNULL(diciembre.OrdenProduccion,0)) as 'Diciembre-OrdenProd',   SUM(IFNULL(Diciembresolic.cantidad,0)) as 'Diciembre-SoliProd'    FROM    tbcorpal_producto p LEFT JOIN tbcorpal_objetivosproduccionmensual op ON p.codigo = op.codprod AND op.anio = year(current_date())    LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 1    GROUP BY     dsp.codproducto ) as Enerosolic ON p.codigo = Enerosolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 2    GROUP BY     dsp.codproducto ) as Febrerosolic  ON p.codigo = Febrerosolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 3    GROUP BY     dsp.codproducto ) as Marzosolic  ON p.codigo = Marzosolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 4    GROUP BY     dsp.codproducto ) as Abrilsolic  ON p.codigo = Abrilsolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 5    GROUP BY     dsp.codproducto ) as Mayosolic  ON p.codigo = Mayosolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 6    GROUP BY     dsp.codproducto ) as Juniosolic  ON p.codigo = Juniosolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 7    GROUP BY     dsp.codproducto ) as Juliosolic  ON p.codigo = Juliosolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 8    GROUP BY     dsp.codproducto ) as Agostosolic ON p.codigo = Agostosolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 9   GROUP BY     dsp.codproducto ) as Septiembresolic  ON p.codigo = Septiembresolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 10   GROUP BY     dsp.codproducto ) as Octubresolic  ON p.codigo = Octubresolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 11   GROUP BY     dsp.codproducto ) as Noviembresolic  ON p.codigo = Noviembresolic.codigo LEFT JOIN  (   SELECT    dsp.codproducto AS 'codigo',   sp.fechaentrega AS 'fecha',   SUM(dsp.cantentregada) AS 'cantidad'   FROM    tbcorpal_solicitudentregaproducto sp   LEFT JOIN tbcorpal_detalle_solicitudproducto dsp ON sp.codigo = dsp.codsolicitud   WHERE    YEAR(sp.fechaentrega) = year(current_date()) AND     MONTH(sp.fechaentrega) = 12   GROUP BY     dsp.codproducto ) as diciembresolic ON p.codigo = diciembresolic.codigo   LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-01-01')      AND op.fechaproduccion <= CONCAT(year(current_date()),'-02-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-01-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-01-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-02-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-02-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS enero    ON p.codigo = enero.codProducto   LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-02-01')      AND op.fechaproduccion <= CONCAT(year(current_date()),'-03-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-02-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-02-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-03-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-03-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS febrero    ON p.codigo = febrero.codProducto   LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-03-01')     AND op.fechaproduccion <= CONCAT(year(current_date()),'-04-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-03-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-03-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-04-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-04-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS marzo    ON p.codigo = marzo.codProducto     LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-04-01')      AND op.fechaproduccion <= CONCAT(year(current_date()),'-05-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-04-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-04-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-05-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-05-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS abril    ON p.codigo = abril.codProducto       LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-05-01')      AND op.fechaproduccion <= CONCAT(year(current_date()),'-06-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-05-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-05-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-06-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-06-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS mayo    ON p.codigo = mayo.codProducto     LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-06-01')      AND op.fechaproduccion <= CONCAT(year(current_date()),'-07-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-06-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-06-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-07-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-07-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS junio    ON p.codigo = junio.codProducto     LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-07-01')      AND op.fechaproduccion <= CONCAT(year(current_date()),'-08-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-07-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-07-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-08-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-08-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS julio    ON p.codigo = julio.codProducto     LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-08-01')      AND op.fechaproduccion <= CONCAT(year(current_date()),'-09-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-08-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-08-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-09-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-09-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS agosto    ON p.codigo = agosto.codProducto       LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-09-01')     AND op.fechaproduccion <= CONCAT(year(current_date()),'-10-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-09-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-09-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-10-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-10-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS septiembre    ON p.codigo = septiembre.codProducto     LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-10-01')     AND op.fechaproduccion <= CONCAT(year(current_date()),'-11-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-10-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-10-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-11-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-11-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS octubre    ON p.codigo = octubre.codProducto     LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-11-01')     AND op.fechaproduccion <= CONCAT(year(current_date()),'-12-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-11-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-11-01') AND op.fechaproduccion < CONCAT(year(current_date()),'-12-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date()),'-12-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS noviembre   ON p.codigo = noviembre.codProducto     LEFT JOIN   (   SELECT     op.codProductonax AS 'codProducto',     op.productoNax,     SUM(op.cantcajasproduccion)AS 'OrdenProduccion'   FROM tbcorpal_ordenproduccion op   WHERE      op.fechaproduccion >= CONCAT(year(current_date()),'-12-01')      AND op.fechaproduccion <= CONCAT(year(current_date())+1,'-01-01')     AND (         (op.fechaproduccion = CONCAT(year(current_date()),'-12-01') AND op.horaproduccion >= '07:00:00')         OR         (op.fechaproduccion > CONCAT(year(current_date()),'-12-01') AND op.fechaproduccion < CONCAT(year(current_date())+1,'-01-01'))         OR         (op.fechaproduccion = CONCAT(year(current_date())+1,'-01-01') AND op.horaproduccion < '07:00:00')     )   GROUP BY       op.codProductonax   ORDER BY     op.fechaproduccion, op.horaproduccion   ) AS diciembre    ON p.codigo = diciembre.codProducto       ";
            DataSet dato = conexion.consultaMySql(consulta);
            return dato;
        }
    }
}